# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитиктура приложения разработана на парагдигме Model-View-Presenter(MVP), она разделяет код на три слоя:

- Слой MOdel - Нужен для хранения данных и их изменения 

- Слой  View -  Нужен для отображения данных на странице 

- Слой  Presenter - Нужен за связь между слоем Model и View 

- В приложении так же будет реализовано событийно-ориентированный подход. 


## Базовые классы 


### Класс Api  
Api нужен для работы с запросами к серверу

#### Методы класса Api:

- handleResponse - он обрабатывает ответ от сервера, если ответ успешный, он возвращает данные 

- get - служит для выполнение Get- запроса, затем обрабатывает ответ через handleresponse

- post- служит для выполнения POST- запроса, затем обрабатывается ответ через handleresponse


### Класс EventEmitter 
EventEmitter реализует систему управления событиями и используется в presenter 

#### Методы класса EventEmitter:

- on: Метод для подписки на событие. Если событие еще не зарегистрировано, оно добавляется в карту, и затем переданный колбек добавляется в набор подписчиков для этого события.

- off: Метод для отмены подписки на событие. Удаляет указанный колбек из набора подписчиков для данного события. Если набор подписчиков становится пустым, событие удаляется из карты.

- emit: Метод для генерации события. Он проходит по всем зарегистрированным событиям и вызывает колбеки для тех, которые соответствуют заданному названию события. Если событие соответствует шаблону (например, регулярному выражению), все соответствующие колбеки будут вызваны.

- onAll: Метод для подписки на все события. Позволяет слушать все события, используя специальное название "*".

- offAll: Метод для сброса всех обработчиков событий. Он очищает карту _events, удаляя все подписки.

- trigger: Метод, который создает колбек, генерирующий событие при вызове. Этот колбек объединяет переданные данные с контекстом и вызывает метод emit.


##  Слой  Model 


### класс DataCardsProduct хранит данные продуктов и работает с ними.

-constructor(event: IEvents) - принимает инстант брокера событий.

#### Поля: 

- productCards: IProduct[] - хранит массив всех продуктов 

- inspectionCard: id:string - выбраный продукт по id для подробного осмотра 


#### Методы:
 
- getProdut(id:string) - метод позволяет получить прокукт по id 

- previewProduct(inspectionCard: id:string) - метод устанавливает данные выбраной карточки продукта 


### Класс CartModel работает и хранит  выбранный пользователем товар в корзине продуктов 

#### Поля:

- cartProdut: TCart[] - массив товаров выбранных пользователем 

- constructor(event: IEvents) - принимает инстант брокера событий.

#### Методы класса CartModel: 

- getProducts(cartProdut: TCart[]) - получаем массив выбранных продуктов 

- getIdAllProduct(id:string) - получение id всех продуктов 
 
- totalSum(): number - считает  общую цену всех продуктов 

- addProductCart():void - метод добавляет продукт в корзину

- deleteProductCart():void - удаляет продукт из корзины 

- clearCart():void - очищает корзину 


### Класс FormModel хранит и  работает с данными от пользователя 

- constructor(event: IEvents ) - принимает инстант брокера событий.

#### Поля:

- payment: string - информация о методе оплаты.

- email: string - электронная почта пользователя.

- phone: number - номер телефона пользователя.

- address: string - адрес пользователя.

- productCart:CartModel - количество товаров и их общая сумма 

- formErrors: string - хранения ошибок валидации


#### Методы класса FormModel:

- getPaymentMethod() - получает способ оплаты 

- getAddresUser() - получает адрес пользователя

- validateAdress() - проверяем поле адреса 

- getDataUser() - получаем  номер телефона и электронную почту

- validateContacts() - провермяем поля с номером телефона и почтой

- getOrden(payment: string, address: string, email: string,  phone: number,productCart:CartModel) - получение всех данных заказа для отправки на сервер 


## Слой  View 

### Класс Page отображает кнопку  корзины со счетчиком товаров и список карточке 

- constructor(Cart: HTMLElement,totalProduct: HTMLElement,product: HTMLElement, events: IEvents) - принимает HTML-элемент  и брокер событие

#### Поля:

- Cart: HTMLElement - кнопка корзины  

- totalProduct: HTMLElement  - количество добавленных продуктов в корзину 

- product: HTMLElement - все карточки 

#### Методы:

- renderCounter() - отображает количество товаров в корзине 

- renderCards() - отображает список карточек продуктов на странице 



### Класс Card отображает карточку товара на странице 

- constructor(template: HTMLTemplateElement, events: IEvents) - принимает Темплат элемент и брокер событие

#### Поля:

- category: HTMLElement - категория продукта 

- img: HTMLElement - картинка продукта 

- title: HTMLElement - названия товара 

- price: HTMLElement - цена товара 


#### Методы:

- cardCategory() - устанавливает категорию карточки 

- cardImg() - устанавливает картинку карточки 

- cardText() - устанавливает название карточки 

- cardPrice() - устанавливает цену карточки 

- renderCard() - отображает полностью карточку 


### Класс cardPreview наследует класс Card и выполняет отображения подробного описания карточки, и позволяет добавлять товар в корзину 

- constructor(template: HTMLTemplateElement, events: IEvents) - принимает Темплат элемент и брокер событие

#### Поля: 

- description: HTMLElement - подробное описания карточки 

- buttonCard: HTMLElement - кнопка добавления товара в корзину 

#### Методы: 

- renderCardPrevieW() - отображает карточку товара в подробном осмотре 


### Класс ProductCart  отвечает за отображения продукта в корзине

- constructor(template: HTMLTemplateElement, events: IEvents) - принимает темплейт элемент и брокер событие 

#### Поля:

- cartItem: HTMLElement - контейнер представляющий одни товар в корзине 

- numberProduct: HTMLElement - порядковый номер продукта 

- productText: HTMLElement - название товара 

- productSum: HTMLElement - цена товара 

- buttonDellete: HTMLElement - кнопка удаления продукта 

#### Методы: 

- renderProductCart() - отображает товар в корзине 


### Класс ModalWindow - отображает модальное окно, его можно закрывать и открывать с заданныи содержимым 

- constructor(modalContainer: HTMLElement, events: IEvents) - принимает HTML-элемент и брокер событие

#### Поля: 

- modalContainer: HTMLElement - контейнер модального окна 

- buttonModal: HTMLElement - кнопка закрытия модального окна 

- contentModal: HTMLElement - контейнер в которое будет загружаться содержимое 

#### Методы: 

- openModal() - открытие модального окна 

- closeModal() - закрытия модального окна 

- getModalContent() - устанавливает содержимое модального окна( у нас 5 разных отображений модальных окнон )

- renderModal() - отображаения модального окна 

- resetModal() - сбросить содержимого модального окна после закрытия


### Класс CartView - показывает список товара в самой корзине и итоговую стоймость 

- constructor(template: HTMLTemplateElement, events: IEvents) - принимает Темплат элемент и брокер событие

#### Поля: 

- cartList: HTMLElement - отображения товаров в корзине 

- buttonCart: HTMLElement - кнопка для оформления заказа 

- cartTotal: HTMLElement - общая стоймость всех продуктов 

#### Методы:

- getItems() -  устанавливает список товаров в корзине 

- renderTotalSum() - отображает общую сумму товаров в корзине 

- renderCart() - отображает корзину 


### Класс FormOrder - управляет отображением окна способа оплаты и адреса доставки, позволяет принять от пользователя способ оплаты и адрес доставки 

- constructor(template: HTMLTemplateElement, events: IEvents) - принимает Темплат элемент и брокер событие

#### Поля: 

- formOrder: HTMLElement -  форма способа оплаты/адреса доставки 

- buttonOnline: HTMLElement - кнопка онлайн

- buttonReceiving: HTMLElement - кнопка при получении 

- inputAddres: HTMLElement - поле ввода  адреса доставки

- formErrors: HTMLElement - элемент, в котором будет отображаться ошибка формы 


#### Методы:

- checkValid() - устанавливает , доступна ли кнопка далее

- renderFormOrder() - отображает форму способа оплаты и адреса доставки 


### Класс FormContacts - управляет отображением окна контакты, позволяет принять от пользователя электронную почту и номер телефона 

- constructor(template: HTMLTemplateElement, events: IEvents) - принимает Темплат элемент и брокер событие

#### Поля: 

- formContact: HTMLElement - форма контактов 

- inputEmail: HTMLElement - поле ввода электронной почты 

- inputNimberPhone: HTMLElement - поле ввода номера телефона 

- buttonPay: HTMLElement - кнопка оплатить заказ

- formErrors: HTMLElement - элемент, в котором будет отображаться ошибка формы


#### Методы:

- renderFormContacts() - отображает форму 


### Класс OrderSuccess отображает сообщение об успешном оформлении заказа 

- constructor(template: HTMLTemplateElement, events: IEvents) - принимает Темплат элемент и брокер событие

#### Поля: 

- success: HTMLElement - контейнер успешного заказа 

- imgSuccess: HTMLElement - картинка (галочка)

- description: HTMLElement - отображения текса что заказ выполнин и сколько было списанно синапсов 

- buttonSuccess: HTMLElement - кнопка за новыми покупками 

#### Методы:

- renderOrderSuccess() - отображает окно с успешным выполненым заказом 


## Слой Presenter 

### класс ApiRequest принимает в конструктор экземпляр класса Api и предоставляет методы работы с бэкендом 

#### Взаимоействие компонентов
Код, описывающий взаимодействие представления и данных между собойнаходится в файле index.ts, выполняющем роль презентера.\
Взаимодействие осуществляется за счет событий генерируемых с помощью брокера событий и обработчиков этих событий, описанных в index.ts.\
В index.ts сначала создаются экземпляры всех необходимых классов, а затем настраивается обработка событий.\

## UML - схема 

![UML - схема](/src/images/UML.png)
